{"ast":null,"code":"import _toConsumableArray from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from'react';import articleAPI from'../../Api/articlesAPI';import Article from'./Article/Article';import CreateArticleForm from'./createArticle';import{Redirect,withRouter}from'react-router-dom';import CreateComment from'../Comments/createComment';var allArticles=/*#__PURE__*/function(_Component){_inherits(allArticles,_Component);var _super=_createSuper(allArticles);function allArticles(){var _this;_classCallCheck(this,allArticles);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={posts:{},isLoaded:false,update:false,updateArticle:null,error:null,isAdmin:false,id:\"\",reqHeader:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}};_this.handleLikeClick=function(id){articleAPI.likeArticle(id,_this.state.reqHeader).then(function(res){console.log(res);var posts=_toConsumableArray(_this.state.posts);var post=posts.find(function(post){return post.id===id;});if(res.status===201){post.likes+=1;}else{post.likes-=1;}_this.setState({posts:posts});}).catch(function(err){return console.log(err);});};_this.handleDeletePost=function(id){articleAPI.deleteArticle(id,_this.state.reqHeader).then(function(){var posts=_toConsumableArray(_this.state.posts);var deletePost=posts.find(function(posts){return posts.id===id;});var removeIndex=posts.map(function(item){return item.id;}).indexOf(deletePost.id);posts.splice(removeIndex,1);_this.setState({posts:posts});console.log(\"Article supprimé\");}).catch(function(err){return console.log(err);});};_this.handleUpdatePost=function(id){_this.setState({update:true,updateArticle:id});};return _this;}_createClass(allArticles,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;articleAPI.getArticles(this.state.reqHeader).then(function(articles){_this2.setState({posts:articles.data.article,isAdmin:articles.data.isAdmin});}).catch(function(err){return console.log(err);});}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,posts=_this$state.posts,update=_this$state.update,updateArticle=_this$state.updateArticle,isAdmin=_this$state.isAdmin;if(update){return/*#__PURE__*/React.createElement(Redirect,{to:'/post/update/'+updateArticle});}var liste=Object.keys(posts).map(function(id){return/*#__PURE__*/React.createElement(Article,{key:posts[id].id,profilePicture:posts[id].User.profilePicture,name:posts[id].User.firstname+' '+posts[id].User.lastname,likes:posts[id].likes,content:posts[id].content,attachment:posts[id].attachment,handleLikeClick:function handleLikeClick(){return _this3.handleLikeClick(posts[id].id);},handleDelete:function handleDelete(){return _this3.handleDeletePost(posts[id].id);},handleUpdate:function handleUpdate(){return _this3.handleUpdatePost(posts[id].id);},commentFormComponent:/*#__PURE__*/React.createElement(CreateComment,{id:posts[id].id}),creator:posts[id].UserId,articleId:posts[id].id,isAdmin:isAdmin});});return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(CreateArticleForm,null),liste);}}]);return allArticles;}(Component);export default withRouter(allArticles);","map":{"version":3,"sources":["/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/src/components/Articles/Articles.js"],"names":["React","Component","Fragment","articleAPI","Article","CreateArticleForm","Redirect","withRouter","CreateComment","allArticles","state","posts","isLoaded","update","updateArticle","error","isAdmin","id","reqHeader","localStorage","getItem","handleLikeClick","likeArticle","then","res","console","log","post","find","status","likes","setState","catch","err","handleDeletePost","deleteArticle","deletePost","removeIndex","map","item","indexOf","splice","handleUpdatePost","getArticles","articles","data","article","liste","Object","keys","User","profilePicture","firstname","lastname","content","attachment","UserId"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport articleAPI from '../../Api/articlesAPI'\nimport Article from './Article/Article';\nimport CreateArticleForm from './createArticle'\nimport { Redirect, withRouter } from 'react-router-dom';\nimport CreateComment from '../Comments/createComment'\n\n\nclass allArticles extends Component {\n\n    state = {\n        posts: {},\n        isLoaded: false,\n        update: false,\n        updateArticle: null,\n        error : null,\n        isAdmin: false,\n        id: \"\",\n        reqHeader: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n    }\n\n    componentDidMount(){\n\n        articleAPI.getArticles(this.state.reqHeader)\n        .then(articles => {\n            \n            this.setState({\n                posts: articles.data.article,\n                isAdmin: articles.data.isAdmin })\n        })\n        .catch(err => console.log(err))\n    }\n\n    handleLikeClick = (id) => {\n        articleAPI.likeArticle(id, this.state.reqHeader)\n        .then((res) => {\n            console.log(res)\n            let posts = [...this.state.posts]\n            let post = posts.find(post => post.id === id)\n            if(res.status === 201){\n                post.likes += 1\n            } else {\n                post.likes -= 1\n            }\n            this.setState({posts})\n        })\n        .catch((err) => console.log(err))\n    }\n\n    handleDeletePost = (id) => {\n        articleAPI.deleteArticle(id, this.state.reqHeader)\n        .then(() => {\n            let posts = [...this.state.posts]\n            let deletePost = posts.find(posts => posts.id === id)\n            var removeIndex = posts.map(function(item) { return item.id; }).indexOf(deletePost.id);\n            posts.splice(removeIndex, 1);\n            this.setState({posts})\n            console.log(\"Article supprimé\")\n        })\n        .catch(err => console.log(err))\n    }\n\n    handleUpdatePost = (id) => {\n        this.setState({update: true, updateArticle: id})\n    }\n\n    render () {\n\n        const {posts, update, updateArticle, isAdmin} = this.state\n\n\n        if(update){\n            return <Redirect to={'/post/update/' + updateArticle } />\n        }\n\n        const liste = Object.keys(posts)\n        .map(id => (\n            <Article \n            key={posts[id].id}\n            profilePicture={posts[id].User.profilePicture}\n            name={posts[id].User.firstname + ' ' + posts[id].User.lastname}\n            likes={posts[id].likes}\n            content={posts[id].content} \n            attachment={posts[id].attachment}\n            handleLikeClick={() => this.handleLikeClick(posts[id].id)}\n            handleDelete={() => this.handleDeletePost(posts[id].id)}\n            handleUpdate={() => this.handleUpdatePost(posts[id].id)}\n            commentFormComponent={<CreateComment id={posts[id].id} />}\n            creator={posts[id].UserId}\n            articleId={posts[id].id}\n            isAdmin={isAdmin}\n            />\n        ))\n\n        return (\n            <Fragment>\n                <CreateArticleForm />\n                {liste}\n            </Fragment>\n        )\n    }\n}\n\nexport default withRouter(allArticles)"]},"metadata":{},"sourceType":"module"}