{"ast":null,"code":"import _toConsumableArray from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from'react';import commentAPI from'../../Api/commentAPI';import Comment from'./Comment';var Comments=/*#__PURE__*/function(_Component){_inherits(Comments,_Component);var _super=_createSuper(Comments);function Comments(){var _this;_classCallCheck(this,Comments);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isAdmin:false,allComment:{},reqHeader:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}};_this.handleDeleteComment=function(articleId,commentId){commentAPI.deleteComments(articleId,commentId,_this.state.reqHeader).then(function(res){var allComment=_toConsumableArray(_this.state.allComment);var comment=allComment.find(function(comment){return comment.id===commentId;});var removeIndex=allComment.map(function(item){return item.id;}).indexOf(comment.id);allComment.splice(removeIndex,1);_this.setState({allComment:allComment});}).catch(function(err){return console.log(err);});};return _this;}_createClass(Comments,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var id=this.props.articleId;commentAPI.getComments(id,this.state.reqHeader).then(function(comments){_this2.setState({allComment:comments.data.comments,isAdmin:comments.data.isAdmin});}).catch(function(err){return console.log(err);});}},{key:\"render\",value:function render(){var _this3=this;var allComment=this.state.allComment;var listeComment=Object.keys(allComment).map(function(id){return/*#__PURE__*/React.createElement(Comment,{key:allComment[id].id,profilePicture:allComment[id].User.profilePicture,name:allComment[id].User.firstname+' '+allComment[id].User.lastname,comment:allComment[id].commentText,handleDeleteComment:function handleDeleteComment(){_this3.handleDeleteComment(allComment[id].ArticleId,allComment[id].id);},creator:allComment[id].UserId,isAdmin:_this3.state.isAdmin});});return/*#__PURE__*/React.createElement(Fragment,null,listeComment);}}]);return Comments;}(Component);export default Comments;","map":{"version":3,"sources":["/Users/maiga/Desktop/DWJ OPC/P7_Maiga_Boubacar/frontend/src/components/Comments/Comments.js"],"names":["React","Component","Fragment","commentAPI","Comment","Comments","state","isAdmin","allComment","reqHeader","localStorage","getItem","handleDeleteComment","articleId","commentId","deleteComments","then","res","comment","find","id","removeIndex","map","item","indexOf","splice","setState","catch","err","console","log","props","getComments","comments","data","listeComment","Object","keys","User","profilePicture","firstname","lastname","commentText","ArticleId","UserId"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport commentAPI from '../../Api/commentAPI'\nimport Comment from './Comment'\n\n\nclass Comments extends Component {\n\n    state = {\n        isAdmin: false,\n        allComment: {},\n        reqHeader: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n    }\n\n    componentDidMount () {\n        const id = this.props.articleId\n        commentAPI.getComments(id, this.state.reqHeader)\n        .then(comments => {\n            this.setState({allComment: comments.data.comments, isAdmin: comments.data.isAdmin })\n        })\n        .catch(err => console.log(err))\n    }\n\n    handleDeleteComment = (articleId, commentId) => {\n        commentAPI.deleteComments(articleId, commentId, this.state.reqHeader)\n        .then(res => {\n            let allComment = [...this.state.allComment]\n            let comment = allComment.find(comment => comment.id === commentId)\n            var removeIndex = allComment.map(function(item) { return item.id; }).indexOf(comment.id);\n            allComment.splice(removeIndex, 1);\n            this.setState({allComment})\n        })\n        .catch(err => console.log(err))\n    }\n\n    render () {\n\n        let {allComment} = this.state\n\n        const listeComment = Object.keys(allComment)\n        .map(id => (\n            <Comment\n                key={allComment[id].id} \n                profilePicture={allComment[id].User.profilePicture}\n                name={allComment[id].User.firstname + ' ' + allComment[id].User.lastname}\n                comment={allComment[id].commentText}\n                handleDeleteComment={() => {this.handleDeleteComment(allComment[id].ArticleId,allComment[id].id)}}\n                creator={allComment[id].UserId}\n                isAdmin={this.state.isAdmin}\n            />\n        ))\n\n\n        return (\n            <Fragment>\n                {listeComment}\n            </Fragment>\n           \n        )\n    }\n}\n\nexport default Comments"]},"metadata":{},"sourceType":"module"}